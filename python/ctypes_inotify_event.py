import ctypes

class InotifyEvent(ctypes.Structure):
    _fields_ = [
        ("wd", ctypes.c_int),
        ("mask", ctypes.c_uint32),
        ("cookie", ctypes.c_uint32),
        ("len", ctypes.c_uint32),
    ]

# 311419 1704857756.956818 read(10, "\253\0\0\0\0\1\0\0\0\0\0\0\20\0\0\0004913\0\0\0\0\0\0\0\0\0\0\0\0\253\0\0\0\10\0\0\0\0\0\0\0\20\0\0\0004913\0\0\0\0\0\0\0\0\0\0\0\0\253\0\0\0\0\2\0\0\0\0\0\0\20\0\0\0004913\0\0\0\0\0\0\0\0\0\0\0\0\253\0\0\0@\0\0\0h\234\27\0\20\0\0\0test.md\0\0\0\0\0\0\0\0\0\253\0\0\0\0\1\0\0\0\0\0\0\20\0\0\0test.md\0\0\0\0\0\0\0\0\0\253\0\0\0\10\0\0\0\0\0\0\0\20\0\0\0test.md\0\0\0\0\0\0\0\0\0", 4096) = 192
s  =b"\253\0\0\0\0\1\0\0\0\0\0\0\20\0\0\0004913\0\0\0\0\0\0\0\0\0\0\0\0\253\0\0\0\10\0\0\0\0\0\0\0\20\0\0\0004913\0\0\0\0\0\0\0\0\0\0\0\0\253\0\0\0\0\2\0\0\0\0\0\0\20\0\0\0004913\0\0\0\0\0\0\0\0\0\0\0\0\253\0\0\0@\0\0\0h\234\27\0\20\0\0\0test.md\0\0\0\0\0\0\0\0\0\253\0\0\0\0\1\0\0\0\0\0\0\20\0\0\0test.md\0\0\0\0\0\0\0\0\0\253\0\0\0\10\0\0\0\0\0\0\0\20\0\0\0test.md\0\0\0\0\0\0\0\0\0"

# IN_CLOSE_WRITE 8
# IN_MOVED_FROM  64
# IN_CREATE      256
# IN_DELETE      512

t = s
while True:
    if not t:
        break
    e = InotifyEvent.from_buffer_copy(t)
    name = t[ctypes.sizeof(e):]
    nulli = name.find(b'\0')
    name = name[:nulli].decode()
    print(f'{e.wd} {e.mask} {e.cookie} {e.len} {name}')
    t = t[ctypes.sizeof(e)+e.len:]
